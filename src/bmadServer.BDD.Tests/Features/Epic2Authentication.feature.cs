// ------------------------------------------------------------------------------
//  <auto-generated>
//      This code was generated by Reqnroll (https://www.reqnroll.net/).
//      Reqnroll Version:2.0.0.0
//      Reqnroll Generator Version:2.0.0.0
// 
//      Changes to this file may cause incorrect behavior and will be lost if
//      the code is regenerated.
//  </auto-generated>
// ------------------------------------------------------------------------------
#region Designer generated code
#pragma warning disable
namespace bmadServer.BDD.Tests.Features
{
    using Reqnroll;
    using System;
    using System.Linq;
    
    
    [System.CodeDom.Compiler.GeneratedCodeAttribute("Reqnroll", "2.0.0.0")]
    [System.Runtime.CompilerServices.CompilerGeneratedAttribute()]
    public partial class UserAuthenticationSessionManagementFeature : object, Xunit.IClassFixture<UserAuthenticationSessionManagementFeature.FixtureData>, Xunit.IAsyncLifetime
    {
        
        private global::Reqnroll.ITestRunner testRunner;
        
        private static string[] featureTags = ((string[])(null));
        
        private static global::Reqnroll.FeatureInfo featureInfo = new global::Reqnroll.FeatureInfo(new System.Globalization.CultureInfo("en"), "Features", "User Authentication & Session Management", "  As a user\n  I want secure authentication\n  So that my data is protected", global::Reqnroll.ProgrammingLanguage.CSharp, featureTags);
        
        private Xunit.Abstractions.ITestOutputHelper _testOutputHelper;
        
#line 1 "Epic2Authentication.feature"
#line hidden
        
        public UserAuthenticationSessionManagementFeature(UserAuthenticationSessionManagementFeature.FixtureData fixtureData, Xunit.Abstractions.ITestOutputHelper testOutputHelper)
        {
            this._testOutputHelper = testOutputHelper;
        }
        
        public static async System.Threading.Tasks.Task FeatureSetupAsync()
        {
        }
        
        public static async System.Threading.Tasks.Task FeatureTearDownAsync()
        {
        }
        
        public async System.Threading.Tasks.Task TestInitializeAsync()
        {
            testRunner = global::Reqnroll.TestRunnerManager.GetTestRunnerForAssembly(featureHint: featureInfo);
            if (((testRunner.FeatureContext != null) 
                        && (testRunner.FeatureContext.FeatureInfo.Equals(featureInfo) == false)))
            {
                await testRunner.OnFeatureEndAsync();
            }
            if ((testRunner.FeatureContext == null))
            {
                await testRunner.OnFeatureStartAsync(featureInfo);
            }
        }
        
        public async System.Threading.Tasks.Task TestTearDownAsync()
        {
            await testRunner.OnScenarioEndAsync();
            global::Reqnroll.TestRunnerManager.ReleaseTestRunner(testRunner);
        }
        
        public void ScenarioInitialize(global::Reqnroll.ScenarioInfo scenarioInfo)
        {
            testRunner.OnScenarioInitialize(scenarioInfo);
            testRunner.ScenarioContext.ScenarioContainer.RegisterInstanceAs<Xunit.Abstractions.ITestOutputHelper>(_testOutputHelper);
        }
        
        public async System.Threading.Tasks.Task ScenarioStartAsync()
        {
            await testRunner.OnScenarioStartAsync();
        }
        
        public async System.Threading.Tasks.Task ScenarioCleanupAsync()
        {
            await testRunner.CollectScenarioErrorsAsync();
        }
        
        public virtual async System.Threading.Tasks.Task FeatureBackgroundAsync()
        {
#line 6
  #line hidden
#line 7
    await testRunner.GivenAsync("bmadServer API is running", ((string)(null)), ((global::Reqnroll.Table)(null)), "Given ");
#line hidden
        }
        
        async System.Threading.Tasks.Task Xunit.IAsyncLifetime.InitializeAsync()
        {
            await this.TestInitializeAsync();
        }
        
        async System.Threading.Tasks.Task Xunit.IAsyncLifetime.DisposeAsync()
        {
            await this.TestTearDownAsync();
        }
        
        [Xunit.SkippableFactAttribute(DisplayName="Register new user with valid credentials")]
        [Xunit.TraitAttribute("FeatureTitle", "User Authentication & Session Management")]
        [Xunit.TraitAttribute("Description", "Register new user with valid credentials")]
        [Xunit.TraitAttribute("Category", "epic-2")]
        [Xunit.TraitAttribute("Category", "story-2-1")]
        [Xunit.TraitAttribute("Category", "security")]
        public async System.Threading.Tasks.Task RegisterNewUserWithValidCredentials()
        {
            string[] tagsOfScenario = new string[] {
                    "epic-2",
                    "story-2-1",
                    "security"};
            System.Collections.Specialized.OrderedDictionary argumentsOfScenario = new System.Collections.Specialized.OrderedDictionary();
            global::Reqnroll.ScenarioInfo scenarioInfo = new global::Reqnroll.ScenarioInfo("Register new user with valid credentials", null, tagsOfScenario, argumentsOfScenario, featureTags);
#line 11
  this.ScenarioInitialize(scenarioInfo);
#line hidden
            if ((global::Reqnroll.TagHelper.ContainsIgnoreTag(scenarioInfo.CombinedTags) || global::Reqnroll.TagHelper.ContainsIgnoreTag(featureTags)))
            {
                testRunner.SkipScenario();
            }
            else
            {
                await this.ScenarioStartAsync();
#line 6
  await this.FeatureBackgroundAsync();
#line hidden
#line 12
    await testRunner.GivenAsync("no user exists with email \"newuser@example.com\"", ((string)(null)), ((global::Reqnroll.Table)(null)), "Given ");
#line hidden
                global::Reqnroll.Table table1 = new global::Reqnroll.Table(new string[] {
                            "email",
                            "newuser@example.com"});
                table1.AddRow(new string[] {
                            "password",
                            "SecurePass123!"});
                table1.AddRow(new string[] {
                            "displayName",
                            "New User"});
#line 13
    await testRunner.WhenAsync("I send POST to \"/api/v1/auth/register\" with:", ((string)(null)), table1, "When ");
#line hidden
#line 17
    await testRunner.ThenAsync("the response status should be 201 Created", ((string)(null)), ((global::Reqnroll.Table)(null)), "Then ");
#line hidden
#line 18
    await testRunner.AndAsync("a User record should be created in the database", ((string)(null)), ((global::Reqnroll.Table)(null)), "And ");
#line hidden
#line 19
    await testRunner.AndAsync("the password should be hashed using bcrypt with cost 12", ((string)(null)), ((global::Reqnroll.Table)(null)), "And ");
#line hidden
            }
            await this.ScenarioCleanupAsync();
        }
        
        [Xunit.SkippableFactAttribute(DisplayName="Reject duplicate email registration")]
        [Xunit.TraitAttribute("FeatureTitle", "User Authentication & Session Management")]
        [Xunit.TraitAttribute("Description", "Reject duplicate email registration")]
        [Xunit.TraitAttribute("Category", "epic-2")]
        [Xunit.TraitAttribute("Category", "story-2-1")]
        public async System.Threading.Tasks.Task RejectDuplicateEmailRegistration()
        {
            string[] tagsOfScenario = new string[] {
                    "epic-2",
                    "story-2-1"};
            System.Collections.Specialized.OrderedDictionary argumentsOfScenario = new System.Collections.Specialized.OrderedDictionary();
            global::Reqnroll.ScenarioInfo scenarioInfo = new global::Reqnroll.ScenarioInfo("Reject duplicate email registration", null, tagsOfScenario, argumentsOfScenario, featureTags);
#line 22
  this.ScenarioInitialize(scenarioInfo);
#line hidden
            if ((global::Reqnroll.TagHelper.ContainsIgnoreTag(scenarioInfo.CombinedTags) || global::Reqnroll.TagHelper.ContainsIgnoreTag(featureTags)))
            {
                testRunner.SkipScenario();
            }
            else
            {
                await this.ScenarioStartAsync();
#line 6
  await this.FeatureBackgroundAsync();
#line hidden
#line 23
    await testRunner.GivenAsync("a user exists with email \"existing@example.com\"", ((string)(null)), ((global::Reqnroll.Table)(null)), "Given ");
#line hidden
                global::Reqnroll.Table table2 = new global::Reqnroll.Table(new string[] {
                            "email",
                            "existing@example.com"});
                table2.AddRow(new string[] {
                            "password",
                            "SecurePass123!"});
                table2.AddRow(new string[] {
                            "displayName",
                            "Duplicate User"});
#line 24
    await testRunner.WhenAsync("I send POST to \"/api/v1/auth/register\" with:", ((string)(null)), table2, "When ");
#line hidden
#line 28
    await testRunner.ThenAsync("the response status should be 409 Conflict", ((string)(null)), ((global::Reqnroll.Table)(null)), "Then ");
#line hidden
#line 29
    await testRunner.AndAsync("the error should indicate \"user already exists\"", ((string)(null)), ((global::Reqnroll.Table)(null)), "And ");
#line hidden
            }
            await this.ScenarioCleanupAsync();
        }
        
        [Xunit.SkippableFactAttribute(DisplayName="Reject weak password registration")]
        [Xunit.TraitAttribute("FeatureTitle", "User Authentication & Session Management")]
        [Xunit.TraitAttribute("Description", "Reject weak password registration")]
        [Xunit.TraitAttribute("Category", "epic-2")]
        [Xunit.TraitAttribute("Category", "story-2-1")]
        public async System.Threading.Tasks.Task RejectWeakPasswordRegistration()
        {
            string[] tagsOfScenario = new string[] {
                    "epic-2",
                    "story-2-1"};
            System.Collections.Specialized.OrderedDictionary argumentsOfScenario = new System.Collections.Specialized.OrderedDictionary();
            global::Reqnroll.ScenarioInfo scenarioInfo = new global::Reqnroll.ScenarioInfo("Reject weak password registration", null, tagsOfScenario, argumentsOfScenario, featureTags);
#line 32
  this.ScenarioInitialize(scenarioInfo);
#line hidden
            if ((global::Reqnroll.TagHelper.ContainsIgnoreTag(scenarioInfo.CombinedTags) || global::Reqnroll.TagHelper.ContainsIgnoreTag(featureTags)))
            {
                testRunner.SkipScenario();
            }
            else
            {
                await this.ScenarioStartAsync();
#line 6
  await this.FeatureBackgroundAsync();
#line hidden
                global::Reqnroll.Table table3 = new global::Reqnroll.Table(new string[] {
                            "email",
                            "weakpass@example.com"});
                table3.AddRow(new string[] {
                            "password",
                            "123"});
                table3.AddRow(new string[] {
                            "displayName",
                            "Weak Pass User"});
#line 33
    await testRunner.WhenAsync("I send POST to \"/api/v1/auth/register\" with:", ((string)(null)), table3, "When ");
#line hidden
#line 37
    await testRunner.ThenAsync("the response status should be 400 Bad Request", ((string)(null)), ((global::Reqnroll.Table)(null)), "Then ");
#line hidden
#line 38
    await testRunner.AndAsync("the error should specify password requirements", ((string)(null)), ((global::Reqnroll.Table)(null)), "And ");
#line hidden
            }
            await this.ScenarioCleanupAsync();
        }
        
        [Xunit.SkippableFactAttribute(DisplayName="Reject invalid email format")]
        [Xunit.TraitAttribute("FeatureTitle", "User Authentication & Session Management")]
        [Xunit.TraitAttribute("Description", "Reject invalid email format")]
        [Xunit.TraitAttribute("Category", "epic-2")]
        [Xunit.TraitAttribute("Category", "story-2-1")]
        public async System.Threading.Tasks.Task RejectInvalidEmailFormat()
        {
            string[] tagsOfScenario = new string[] {
                    "epic-2",
                    "story-2-1"};
            System.Collections.Specialized.OrderedDictionary argumentsOfScenario = new System.Collections.Specialized.OrderedDictionary();
            global::Reqnroll.ScenarioInfo scenarioInfo = new global::Reqnroll.ScenarioInfo("Reject invalid email format", null, tagsOfScenario, argumentsOfScenario, featureTags);
#line 41
  this.ScenarioInitialize(scenarioInfo);
#line hidden
            if ((global::Reqnroll.TagHelper.ContainsIgnoreTag(scenarioInfo.CombinedTags) || global::Reqnroll.TagHelper.ContainsIgnoreTag(featureTags)))
            {
                testRunner.SkipScenario();
            }
            else
            {
                await this.ScenarioStartAsync();
#line 6
  await this.FeatureBackgroundAsync();
#line hidden
                global::Reqnroll.Table table4 = new global::Reqnroll.Table(new string[] {
                            "email",
                            "invalid-email"});
                table4.AddRow(new string[] {
                            "password",
                            "SecurePass123!"});
                table4.AddRow(new string[] {
                            "displayName",
                            "Invalid Email User"});
#line 42
    await testRunner.WhenAsync("I send POST to \"/api/v1/auth/register\" with:", ((string)(null)), table4, "When ");
#line hidden
#line 46
    await testRunner.ThenAsync("the response status should be 400 Bad Request", ((string)(null)), ((global::Reqnroll.Table)(null)), "Then ");
#line hidden
#line 47
    await testRunner.AndAsync("the error should indicate invalid email format", ((string)(null)), ((global::Reqnroll.Table)(null)), "And ");
#line hidden
            }
            await this.ScenarioCleanupAsync();
        }
        
        [Xunit.SkippableFactAttribute(DisplayName="Login generates JWT token with correct expiry")]
        [Xunit.TraitAttribute("FeatureTitle", "User Authentication & Session Management")]
        [Xunit.TraitAttribute("Description", "Login generates JWT token with correct expiry")]
        [Xunit.TraitAttribute("Category", "epic-2")]
        [Xunit.TraitAttribute("Category", "story-2-2")]
        [Xunit.TraitAttribute("Category", "security")]
        public async System.Threading.Tasks.Task LoginGeneratesJWTTokenWithCorrectExpiry()
        {
            string[] tagsOfScenario = new string[] {
                    "epic-2",
                    "story-2-2",
                    "security"};
            System.Collections.Specialized.OrderedDictionary argumentsOfScenario = new System.Collections.Specialized.OrderedDictionary();
            global::Reqnroll.ScenarioInfo scenarioInfo = new global::Reqnroll.ScenarioInfo("Login generates JWT token with correct expiry", null, tagsOfScenario, argumentsOfScenario, featureTags);
#line 51
  this.ScenarioInitialize(scenarioInfo);
#line hidden
            if ((global::Reqnroll.TagHelper.ContainsIgnoreTag(scenarioInfo.CombinedTags) || global::Reqnroll.TagHelper.ContainsIgnoreTag(featureTags)))
            {
                testRunner.SkipScenario();
            }
            else
            {
                await this.ScenarioStartAsync();
#line 6
  await this.FeatureBackgroundAsync();
#line hidden
#line 52
    await testRunner.GivenAsync("a user exists with email \"testuser@example.com\" and password \"SecurePass123!\"", ((string)(null)), ((global::Reqnroll.Table)(null)), "Given ");
#line hidden
                global::Reqnroll.Table table5 = new global::Reqnroll.Table(new string[] {
                            "email",
                            "testuser@example.com"});
                table5.AddRow(new string[] {
                            "password",
                            "SecurePass123!"});
#line 53
    await testRunner.WhenAsync("I send POST to \"/api/v1/auth/login\" with:", ((string)(null)), table5, "When ");
#line hidden
#line 56
    await testRunner.ThenAsync("the response status should be 200 OK", ((string)(null)), ((global::Reqnroll.Table)(null)), "Then ");
#line hidden
#line 57
    await testRunner.AndAsync("the response should contain an accessToken", ((string)(null)), ((global::Reqnroll.Table)(null)), "And ");
#line hidden
#line 58
    await testRunner.AndAsync("the JWT should expire in 15 minutes", ((string)(null)), ((global::Reqnroll.Table)(null)), "And ");
#line hidden
            }
            await this.ScenarioCleanupAsync();
        }
        
        [Xunit.SkippableFactAttribute(DisplayName="Login with incorrect password fails")]
        [Xunit.TraitAttribute("FeatureTitle", "User Authentication & Session Management")]
        [Xunit.TraitAttribute("Description", "Login with incorrect password fails")]
        [Xunit.TraitAttribute("Category", "epic-2")]
        [Xunit.TraitAttribute("Category", "story-2-2")]
        public async System.Threading.Tasks.Task LoginWithIncorrectPasswordFails()
        {
            string[] tagsOfScenario = new string[] {
                    "epic-2",
                    "story-2-2"};
            System.Collections.Specialized.OrderedDictionary argumentsOfScenario = new System.Collections.Specialized.OrderedDictionary();
            global::Reqnroll.ScenarioInfo scenarioInfo = new global::Reqnroll.ScenarioInfo("Login with incorrect password fails", null, tagsOfScenario, argumentsOfScenario, featureTags);
#line 61
  this.ScenarioInitialize(scenarioInfo);
#line hidden
            if ((global::Reqnroll.TagHelper.ContainsIgnoreTag(scenarioInfo.CombinedTags) || global::Reqnroll.TagHelper.ContainsIgnoreTag(featureTags)))
            {
                testRunner.SkipScenario();
            }
            else
            {
                await this.ScenarioStartAsync();
#line 6
  await this.FeatureBackgroundAsync();
#line hidden
#line 62
    await testRunner.GivenAsync("a user exists with email \"testuser@example.com\" and password \"SecurePass123!\"", ((string)(null)), ((global::Reqnroll.Table)(null)), "Given ");
#line hidden
                global::Reqnroll.Table table6 = new global::Reqnroll.Table(new string[] {
                            "email",
                            "testuser@example.com"});
                table6.AddRow(new string[] {
                            "password",
                            "WrongPassword!"});
#line 63
    await testRunner.WhenAsync("I send POST to \"/api/v1/auth/login\" with:", ((string)(null)), table6, "When ");
#line hidden
#line 66
    await testRunner.ThenAsync("the response status should be 401 Unauthorized", ((string)(null)), ((global::Reqnroll.Table)(null)), "Then ");
#line hidden
#line 67
    await testRunner.AndAsync("the error message should be \"Invalid email or password\"", ((string)(null)), ((global::Reqnroll.Table)(null)), "And ");
#line hidden
            }
            await this.ScenarioCleanupAsync();
        }
        
        [Xunit.SkippableFactAttribute(DisplayName="Protected endpoint requires valid JWT")]
        [Xunit.TraitAttribute("FeatureTitle", "User Authentication & Session Management")]
        [Xunit.TraitAttribute("Description", "Protected endpoint requires valid JWT")]
        [Xunit.TraitAttribute("Category", "epic-2")]
        [Xunit.TraitAttribute("Category", "story-2-2")]
        [Xunit.TraitAttribute("Category", "security")]
        public async System.Threading.Tasks.Task ProtectedEndpointRequiresValidJWT()
        {
            string[] tagsOfScenario = new string[] {
                    "epic-2",
                    "story-2-2",
                    "security"};
            System.Collections.Specialized.OrderedDictionary argumentsOfScenario = new System.Collections.Specialized.OrderedDictionary();
            global::Reqnroll.ScenarioInfo scenarioInfo = new global::Reqnroll.ScenarioInfo("Protected endpoint requires valid JWT", null, tagsOfScenario, argumentsOfScenario, featureTags);
#line 70
  this.ScenarioInitialize(scenarioInfo);
#line hidden
            if ((global::Reqnroll.TagHelper.ContainsIgnoreTag(scenarioInfo.CombinedTags) || global::Reqnroll.TagHelper.ContainsIgnoreTag(featureTags)))
            {
                testRunner.SkipScenario();
            }
            else
            {
                await this.ScenarioStartAsync();
#line 6
  await this.FeatureBackgroundAsync();
#line hidden
#line 71
    await testRunner.GivenAsync("I have a valid JWT token", ((string)(null)), ((global::Reqnroll.Table)(null)), "Given ");
#line hidden
#line 72
    await testRunner.WhenAsync("I send GET to \"/api/v1/users/me\" with the Authorization header", ((string)(null)), ((global::Reqnroll.Table)(null)), "When ");
#line hidden
#line 73
    await testRunner.ThenAsync("the response status should be 200 OK", ((string)(null)), ((global::Reqnroll.Table)(null)), "Then ");
#line hidden
#line 74
    await testRunner.AndAsync("the response should contain my user profile", ((string)(null)), ((global::Reqnroll.Table)(null)), "And ");
#line hidden
            }
            await this.ScenarioCleanupAsync();
        }
        
        [Xunit.SkippableFactAttribute(DisplayName="Expired JWT is rejected")]
        [Xunit.TraitAttribute("FeatureTitle", "User Authentication & Session Management")]
        [Xunit.TraitAttribute("Description", "Expired JWT is rejected")]
        [Xunit.TraitAttribute("Category", "epic-2")]
        [Xunit.TraitAttribute("Category", "story-2-2")]
        public async System.Threading.Tasks.Task ExpiredJWTIsRejected()
        {
            string[] tagsOfScenario = new string[] {
                    "epic-2",
                    "story-2-2"};
            System.Collections.Specialized.OrderedDictionary argumentsOfScenario = new System.Collections.Specialized.OrderedDictionary();
            global::Reqnroll.ScenarioInfo scenarioInfo = new global::Reqnroll.ScenarioInfo("Expired JWT is rejected", null, tagsOfScenario, argumentsOfScenario, featureTags);
#line 77
  this.ScenarioInitialize(scenarioInfo);
#line hidden
            if ((global::Reqnroll.TagHelper.ContainsIgnoreTag(scenarioInfo.CombinedTags) || global::Reqnroll.TagHelper.ContainsIgnoreTag(featureTags)))
            {
                testRunner.SkipScenario();
            }
            else
            {
                await this.ScenarioStartAsync();
#line 6
  await this.FeatureBackgroundAsync();
#line hidden
#line 78
    await testRunner.GivenAsync("I have an expired JWT token", ((string)(null)), ((global::Reqnroll.Table)(null)), "Given ");
#line hidden
#line 79
    await testRunner.WhenAsync("I send GET to \"/api/v1/users/me\" with the Authorization header", ((string)(null)), ((global::Reqnroll.Table)(null)), "When ");
#line hidden
#line 80
    await testRunner.ThenAsync("the response status should be 401 Unauthorized", ((string)(null)), ((global::Reqnroll.Table)(null)), "Then ");
#line hidden
#line 81
    await testRunner.AndAsync("the error should indicate token expired", ((string)(null)), ((global::Reqnroll.Table)(null)), "And ");
#line hidden
            }
            await this.ScenarioCleanupAsync();
        }
        
        [Xunit.SkippableFactAttribute(DisplayName="Malformed JWT is rejected")]
        [Xunit.TraitAttribute("FeatureTitle", "User Authentication & Session Management")]
        [Xunit.TraitAttribute("Description", "Malformed JWT is rejected")]
        [Xunit.TraitAttribute("Category", "epic-2")]
        [Xunit.TraitAttribute("Category", "story-2-2")]
        public async System.Threading.Tasks.Task MalformedJWTIsRejected()
        {
            string[] tagsOfScenario = new string[] {
                    "epic-2",
                    "story-2-2"};
            System.Collections.Specialized.OrderedDictionary argumentsOfScenario = new System.Collections.Specialized.OrderedDictionary();
            global::Reqnroll.ScenarioInfo scenarioInfo = new global::Reqnroll.ScenarioInfo("Malformed JWT is rejected", null, tagsOfScenario, argumentsOfScenario, featureTags);
#line 84
  this.ScenarioInitialize(scenarioInfo);
#line hidden
            if ((global::Reqnroll.TagHelper.ContainsIgnoreTag(scenarioInfo.CombinedTags) || global::Reqnroll.TagHelper.ContainsIgnoreTag(featureTags)))
            {
                testRunner.SkipScenario();
            }
            else
            {
                await this.ScenarioStartAsync();
#line 6
  await this.FeatureBackgroundAsync();
#line hidden
#line 85
    await testRunner.GivenAsync("I have a malformed JWT token", ((string)(null)), ((global::Reqnroll.Table)(null)), "Given ");
#line hidden
#line 86
    await testRunner.WhenAsync("I send GET to \"/api/v1/users/me\" with the Authorization header", ((string)(null)), ((global::Reqnroll.Table)(null)), "When ");
#line hidden
#line 87
    await testRunner.ThenAsync("the response status should be 401 Unauthorized", ((string)(null)), ((global::Reqnroll.Table)(null)), "Then ");
#line hidden
#line 88
    await testRunner.AndAsync("the error should indicate invalid token", ((string)(null)), ((global::Reqnroll.Table)(null)), "And ");
#line hidden
            }
            await this.ScenarioCleanupAsync();
        }
        
        [Xunit.SkippableFactAttribute(DisplayName="Login sets HttpOnly refresh token cookie")]
        [Xunit.TraitAttribute("FeatureTitle", "User Authentication & Session Management")]
        [Xunit.TraitAttribute("Description", "Login sets HttpOnly refresh token cookie")]
        [Xunit.TraitAttribute("Category", "epic-2")]
        [Xunit.TraitAttribute("Category", "story-2-3")]
        [Xunit.TraitAttribute("Category", "security")]
        public async System.Threading.Tasks.Task LoginSetsHttpOnlyRefreshTokenCookie()
        {
            string[] tagsOfScenario = new string[] {
                    "epic-2",
                    "story-2-3",
                    "security"};
            System.Collections.Specialized.OrderedDictionary argumentsOfScenario = new System.Collections.Specialized.OrderedDictionary();
            global::Reqnroll.ScenarioInfo scenarioInfo = new global::Reqnroll.ScenarioInfo("Login sets HttpOnly refresh token cookie", null, tagsOfScenario, argumentsOfScenario, featureTags);
#line 92
  this.ScenarioInitialize(scenarioInfo);
#line hidden
            if ((global::Reqnroll.TagHelper.ContainsIgnoreTag(scenarioInfo.CombinedTags) || global::Reqnroll.TagHelper.ContainsIgnoreTag(featureTags)))
            {
                testRunner.SkipScenario();
            }
            else
            {
                await this.ScenarioStartAsync();
#line 6
  await this.FeatureBackgroundAsync();
#line hidden
#line 93
    await testRunner.GivenAsync("a user exists with email \"testuser@example.com\" and password \"SecurePass123!\"", ((string)(null)), ((global::Reqnroll.Table)(null)), "Given ");
#line hidden
#line 94
    await testRunner.WhenAsync("I successfully login", ((string)(null)), ((global::Reqnroll.Table)(null)), "When ");
#line hidden
#line 95
    await testRunner.ThenAsync("a refresh token UUID should be generated", ((string)(null)), ((global::Reqnroll.Table)(null)), "Then ");
#line hidden
#line 96
    await testRunner.AndAsync("the token hash should be stored in RefreshTokens table", ((string)(null)), ((global::Reqnroll.Table)(null)), "And ");
#line hidden
#line 97
    await testRunner.AndAsync("an HttpOnly cookie should be set with Secure and SameSite=Strict", ((string)(null)), ((global::Reqnroll.Table)(null)), "And ");
#line hidden
            }
            await this.ScenarioCleanupAsync();
        }
        
        [Xunit.SkippableFactAttribute(DisplayName="Refresh token rotation works correctly")]
        [Xunit.TraitAttribute("FeatureTitle", "User Authentication & Session Management")]
        [Xunit.TraitAttribute("Description", "Refresh token rotation works correctly")]
        [Xunit.TraitAttribute("Category", "epic-2")]
        [Xunit.TraitAttribute("Category", "story-2-3")]
        public async System.Threading.Tasks.Task RefreshTokenRotationWorksCorrectly()
        {
            string[] tagsOfScenario = new string[] {
                    "epic-2",
                    "story-2-3"};
            System.Collections.Specialized.OrderedDictionary argumentsOfScenario = new System.Collections.Specialized.OrderedDictionary();
            global::Reqnroll.ScenarioInfo scenarioInfo = new global::Reqnroll.ScenarioInfo("Refresh token rotation works correctly", null, tagsOfScenario, argumentsOfScenario, featureTags);
#line 100
  this.ScenarioInitialize(scenarioInfo);
#line hidden
            if ((global::Reqnroll.TagHelper.ContainsIgnoreTag(scenarioInfo.CombinedTags) || global::Reqnroll.TagHelper.ContainsIgnoreTag(featureTags)))
            {
                testRunner.SkipScenario();
            }
            else
            {
                await this.ScenarioStartAsync();
#line 6
  await this.FeatureBackgroundAsync();
#line hidden
#line 101
    await testRunner.GivenAsync("I have a valid refresh token cookie", ((string)(null)), ((global::Reqnroll.Table)(null)), "Given ");
#line hidden
#line 102
    await testRunner.AndAsync("my access token is about to expire", ((string)(null)), ((global::Reqnroll.Table)(null)), "And ");
#line hidden
#line 103
    await testRunner.WhenAsync("I send POST to \"/api/v1/auth/refresh\"", ((string)(null)), ((global::Reqnroll.Table)(null)), "When ");
#line hidden
#line 104
    await testRunner.ThenAsync("the response status should be 200 OK", ((string)(null)), ((global::Reqnroll.Table)(null)), "Then ");
#line hidden
#line 105
    await testRunner.AndAsync("a new access token should be returned", ((string)(null)), ((global::Reqnroll.Table)(null)), "And ");
#line hidden
#line 106
    await testRunner.AndAsync("the refresh token should be rotated", ((string)(null)), ((global::Reqnroll.Table)(null)), "And ");
#line hidden
            }
            await this.ScenarioCleanupAsync();
        }
        
        [Xunit.SkippableFactAttribute(DisplayName="Reused refresh token revokes all user tokens")]
        [Xunit.TraitAttribute("FeatureTitle", "User Authentication & Session Management")]
        [Xunit.TraitAttribute("Description", "Reused refresh token revokes all user tokens")]
        [Xunit.TraitAttribute("Category", "epic-2")]
        [Xunit.TraitAttribute("Category", "story-2-3")]
        [Xunit.TraitAttribute("Category", "security")]
        public async System.Threading.Tasks.Task ReusedRefreshTokenRevokesAllUserTokens()
        {
            string[] tagsOfScenario = new string[] {
                    "epic-2",
                    "story-2-3",
                    "security"};
            System.Collections.Specialized.OrderedDictionary argumentsOfScenario = new System.Collections.Specialized.OrderedDictionary();
            global::Reqnroll.ScenarioInfo scenarioInfo = new global::Reqnroll.ScenarioInfo("Reused refresh token revokes all user tokens", null, tagsOfScenario, argumentsOfScenario, featureTags);
#line 109
  this.ScenarioInitialize(scenarioInfo);
#line hidden
            if ((global::Reqnroll.TagHelper.ContainsIgnoreTag(scenarioInfo.CombinedTags) || global::Reqnroll.TagHelper.ContainsIgnoreTag(featureTags)))
            {
                testRunner.SkipScenario();
            }
            else
            {
                await this.ScenarioStartAsync();
#line 6
  await this.FeatureBackgroundAsync();
#line hidden
#line 110
    await testRunner.GivenAsync("I have a previously used refresh token", ((string)(null)), ((global::Reqnroll.Table)(null)), "Given ");
#line hidden
#line 111
    await testRunner.WhenAsync("I send POST to \"/api/v1/auth/refresh\" with the old token", ((string)(null)), ((global::Reqnroll.Table)(null)), "When ");
#line hidden
#line 112
    await testRunner.ThenAsync("the response status should be 401 Unauthorized", ((string)(null)), ((global::Reqnroll.Table)(null)), "Then ");
#line hidden
#line 113
    await testRunner.AndAsync("ALL user tokens should be revoked", ((string)(null)), ((global::Reqnroll.Table)(null)), "And ");
#line hidden
            }
            await this.ScenarioCleanupAsync();
        }
        
        [Xunit.SkippableFactAttribute(DisplayName="Logout clears refresh token")]
        [Xunit.TraitAttribute("FeatureTitle", "User Authentication & Session Management")]
        [Xunit.TraitAttribute("Description", "Logout clears refresh token")]
        [Xunit.TraitAttribute("Category", "epic-2")]
        [Xunit.TraitAttribute("Category", "story-2-3")]
        public async System.Threading.Tasks.Task LogoutClearsRefreshToken()
        {
            string[] tagsOfScenario = new string[] {
                    "epic-2",
                    "story-2-3"};
            System.Collections.Specialized.OrderedDictionary argumentsOfScenario = new System.Collections.Specialized.OrderedDictionary();
            global::Reqnroll.ScenarioInfo scenarioInfo = new global::Reqnroll.ScenarioInfo("Logout clears refresh token", null, tagsOfScenario, argumentsOfScenario, featureTags);
#line 116
  this.ScenarioInitialize(scenarioInfo);
#line hidden
            if ((global::Reqnroll.TagHelper.ContainsIgnoreTag(scenarioInfo.CombinedTags) || global::Reqnroll.TagHelper.ContainsIgnoreTag(featureTags)))
            {
                testRunner.SkipScenario();
            }
            else
            {
                await this.ScenarioStartAsync();
#line 6
  await this.FeatureBackgroundAsync();
#line hidden
#line 117
    await testRunner.GivenAsync("I am logged in with a valid session", ((string)(null)), ((global::Reqnroll.Table)(null)), "Given ");
#line hidden
#line 118
    await testRunner.WhenAsync("I send POST to \"/api/v1/auth/logout\"", ((string)(null)), ((global::Reqnroll.Table)(null)), "When ");
#line hidden
#line 119
    await testRunner.ThenAsync("the response status should be 204 No Content", ((string)(null)), ((global::Reqnroll.Table)(null)), "Then ");
#line hidden
#line 120
    await testRunner.AndAsync("the refresh token should be revoked", ((string)(null)), ((global::Reqnroll.Table)(null)), "And ");
#line hidden
#line 121
    await testRunner.AndAsync("the cookie should be cleared", ((string)(null)), ((global::Reqnroll.Table)(null)), "And ");
#line hidden
            }
            await this.ScenarioCleanupAsync();
        }
        
        [Xunit.SkippableFactAttribute(DisplayName="SignalR connection creates session record")]
        [Xunit.TraitAttribute("FeatureTitle", "User Authentication & Session Management")]
        [Xunit.TraitAttribute("Description", "SignalR connection creates session record")]
        [Xunit.TraitAttribute("Category", "epic-2")]
        [Xunit.TraitAttribute("Category", "story-2-4")]
        public async System.Threading.Tasks.Task SignalRConnectionCreatesSessionRecord()
        {
            string[] tagsOfScenario = new string[] {
                    "epic-2",
                    "story-2-4"};
            System.Collections.Specialized.OrderedDictionary argumentsOfScenario = new System.Collections.Specialized.OrderedDictionary();
            global::Reqnroll.ScenarioInfo scenarioInfo = new global::Reqnroll.ScenarioInfo("SignalR connection creates session record", null, tagsOfScenario, argumentsOfScenario, featureTags);
#line 125
  this.ScenarioInitialize(scenarioInfo);
#line hidden
            if ((global::Reqnroll.TagHelper.ContainsIgnoreTag(scenarioInfo.CombinedTags) || global::Reqnroll.TagHelper.ContainsIgnoreTag(featureTags)))
            {
                testRunner.SkipScenario();
            }
            else
            {
                await this.ScenarioStartAsync();
#line 6
  await this.FeatureBackgroundAsync();
#line hidden
#line 126
    await testRunner.GivenAsync("I am authenticated", ((string)(null)), ((global::Reqnroll.Table)(null)), "Given ");
#line hidden
#line 127
    await testRunner.WhenAsync("my SignalR connection establishes", ((string)(null)), ((global::Reqnroll.Table)(null)), "When ");
#line hidden
#line 128
    await testRunner.ThenAsync("a Session record should be created", ((string)(null)), ((global::Reqnroll.Table)(null)), "Then ");
#line hidden
#line 129
    await testRunner.AndAsync("it should include UserId and ConnectionId", ((string)(null)), ((global::Reqnroll.Table)(null)), "And ");
#line hidden
#line 130
    await testRunner.AndAsync("ExpiresAt should be set to 30 minutes from now", ((string)(null)), ((global::Reqnroll.Table)(null)), "And ");
#line hidden
            }
            await this.ScenarioCleanupAsync();
        }
        
        [Xunit.SkippableFactAttribute(DisplayName="Session recovery within 60 seconds")]
        [Xunit.TraitAttribute("FeatureTitle", "User Authentication & Session Management")]
        [Xunit.TraitAttribute("Description", "Session recovery within 60 seconds")]
        [Xunit.TraitAttribute("Category", "epic-2")]
        [Xunit.TraitAttribute("Category", "story-2-4")]
        public async System.Threading.Tasks.Task SessionRecoveryWithin60Seconds()
        {
            string[] tagsOfScenario = new string[] {
                    "epic-2",
                    "story-2-4"};
            System.Collections.Specialized.OrderedDictionary argumentsOfScenario = new System.Collections.Specialized.OrderedDictionary();
            global::Reqnroll.ScenarioInfo scenarioInfo = new global::Reqnroll.ScenarioInfo("Session recovery within 60 seconds", null, tagsOfScenario, argumentsOfScenario, featureTags);
#line 133
  this.ScenarioInitialize(scenarioInfo);
#line hidden
            if ((global::Reqnroll.TagHelper.ContainsIgnoreTag(scenarioInfo.CombinedTags) || global::Reqnroll.TagHelper.ContainsIgnoreTag(featureTags)))
            {
                testRunner.SkipScenario();
            }
            else
            {
                await this.ScenarioStartAsync();
#line 6
  await this.FeatureBackgroundAsync();
#line hidden
#line 134
    await testRunner.GivenAsync("I have an active session", ((string)(null)), ((global::Reqnroll.Table)(null)), "Given ");
#line hidden
#line 135
    await testRunner.AndAsync("my network connection drops", ((string)(null)), ((global::Reqnroll.Table)(null)), "And ");
#line hidden
#line 136
    await testRunner.WhenAsync("I reconnect within 60 seconds", ((string)(null)), ((global::Reqnroll.Table)(null)), "When ");
#line hidden
#line 137
    await testRunner.ThenAsync("the system should match my userId", ((string)(null)), ((global::Reqnroll.Table)(null)), "Then ");
#line hidden
#line 138
    await testRunner.AndAsync("validate that the session is not expired", ((string)(null)), ((global::Reqnroll.Table)(null)), "And ");
#line hidden
#line 139
    await testRunner.AndAsync("associate the new ConnectionId", ((string)(null)), ((global::Reqnroll.Table)(null)), "And ");
#line hidden
#line 140
    await testRunner.AndAsync("send SESSION_RESTORED SignalR message", ((string)(null)), ((global::Reqnroll.Table)(null)), "And ");
#line hidden
            }
            await this.ScenarioCleanupAsync();
        }
        
        [Xunit.SkippableFactAttribute(DisplayName="Session recovery after 60 seconds creates new session")]
        [Xunit.TraitAttribute("FeatureTitle", "User Authentication & Session Management")]
        [Xunit.TraitAttribute("Description", "Session recovery after 60 seconds creates new session")]
        [Xunit.TraitAttribute("Category", "epic-2")]
        [Xunit.TraitAttribute("Category", "story-2-4")]
        public async System.Threading.Tasks.Task SessionRecoveryAfter60SecondsCreatesNewSession()
        {
            string[] tagsOfScenario = new string[] {
                    "epic-2",
                    "story-2-4"};
            System.Collections.Specialized.OrderedDictionary argumentsOfScenario = new System.Collections.Specialized.OrderedDictionary();
            global::Reqnroll.ScenarioInfo scenarioInfo = new global::Reqnroll.ScenarioInfo("Session recovery after 60 seconds creates new session", null, tagsOfScenario, argumentsOfScenario, featureTags);
#line 143
  this.ScenarioInitialize(scenarioInfo);
#line hidden
            if ((global::Reqnroll.TagHelper.ContainsIgnoreTag(scenarioInfo.CombinedTags) || global::Reqnroll.TagHelper.ContainsIgnoreTag(featureTags)))
            {
                testRunner.SkipScenario();
            }
            else
            {
                await this.ScenarioStartAsync();
#line 6
  await this.FeatureBackgroundAsync();
#line hidden
#line 144
    await testRunner.GivenAsync("I have an active session", ((string)(null)), ((global::Reqnroll.Table)(null)), "Given ");
#line hidden
#line 145
    await testRunner.AndAsync("I disconnect", ((string)(null)), ((global::Reqnroll.Table)(null)), "And ");
#line hidden
#line 146
    await testRunner.WhenAsync("I reconnect after 61 seconds", ((string)(null)), ((global::Reqnroll.Table)(null)), "When ");
#line hidden
#line 147
    await testRunner.ThenAsync("a NEW session should be created", ((string)(null)), ((global::Reqnroll.Table)(null)), "Then ");
#line hidden
#line 148
    await testRunner.ButAsync("workflow state should be recovered", ((string)(null)), ((global::Reqnroll.Table)(null)), "But ");
#line hidden
#line 149
    await testRunner.AndAsync("message \"Session recovered from last checkpoint\" should display", ((string)(null)), ((global::Reqnroll.Table)(null)), "And ");
#line hidden
            }
            await this.ScenarioCleanupAsync();
        }
        
        [Xunit.SkippableFactAttribute(DisplayName="Optimistic concurrency prevents conflicts")]
        [Xunit.TraitAttribute("FeatureTitle", "User Authentication & Session Management")]
        [Xunit.TraitAttribute("Description", "Optimistic concurrency prevents conflicts")]
        [Xunit.TraitAttribute("Category", "epic-2")]
        [Xunit.TraitAttribute("Category", "story-2-4")]
        [Xunit.TraitAttribute("Category", "concurrency")]
        public async System.Threading.Tasks.Task OptimisticConcurrencyPreventsConflicts()
        {
            string[] tagsOfScenario = new string[] {
                    "epic-2",
                    "story-2-4",
                    "concurrency"};
            System.Collections.Specialized.OrderedDictionary argumentsOfScenario = new System.Collections.Specialized.OrderedDictionary();
            global::Reqnroll.ScenarioInfo scenarioInfo = new global::Reqnroll.ScenarioInfo("Optimistic concurrency prevents conflicts", null, tagsOfScenario, argumentsOfScenario, featureTags);
#line 152
  this.ScenarioInitialize(scenarioInfo);
#line hidden
            if ((global::Reqnroll.TagHelper.ContainsIgnoreTag(scenarioInfo.CombinedTags) || global::Reqnroll.TagHelper.ContainsIgnoreTag(featureTags)))
            {
                testRunner.SkipScenario();
            }
            else
            {
                await this.ScenarioStartAsync();
#line 6
  await this.FeatureBackgroundAsync();
#line hidden
#line 153
    await testRunner.GivenAsync("I have multiple active sessions on different devices", ((string)(null)), ((global::Reqnroll.Table)(null)), "Given ");
#line hidden
#line 154
    await testRunner.WhenAsync("two devices update workflow state simultaneously", ((string)(null)), ((global::Reqnroll.Table)(null)), "When ");
#line hidden
#line 155
    await testRunner.ThenAsync("the system should detect version mismatch", ((string)(null)), ((global::Reqnroll.Table)(null)), "Then ");
#line hidden
#line 156
    await testRunner.AndAsync("the second update should fail with 409 Conflict", ((string)(null)), ((global::Reqnroll.Table)(null)), "And ");
#line hidden
            }
            await this.ScenarioCleanupAsync();
        }
        
        [System.CodeDom.Compiler.GeneratedCodeAttribute("Reqnroll", "2.0.0.0")]
        [System.Runtime.CompilerServices.CompilerGeneratedAttribute()]
        public class FixtureData : object, Xunit.IAsyncLifetime
        {
            
            async System.Threading.Tasks.Task Xunit.IAsyncLifetime.InitializeAsync()
            {
                await UserAuthenticationSessionManagementFeature.FeatureSetupAsync();
            }
            
            async System.Threading.Tasks.Task Xunit.IAsyncLifetime.DisposeAsync()
            {
                await UserAuthenticationSessionManagementFeature.FeatureTearDownAsync();
            }
        }
    }
}
#pragma warning restore
#endregion
